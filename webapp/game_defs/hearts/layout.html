<style type="text/css">
.zone {
    float: left;
    width: 80px;
    height: 100px;
    margin: 5px;
    padding: 15px;
    border: 1px dotted #ccc;
}

.zone#hand {
    width: 200px;
}

.zone.last {
    float: right;
}

.victory {
    float: right;
}

.vertical-fan {
    height: 350px;
}

.vertical-fan img {
    margin-bottom: -68px;
}

.horizontal-fan {
    width: 350px;
}

.horizontal-fan img {
    margin-left: -17px;
}

.horizontal-fan .facing-up img {
    margin-right: -17px;
}

.facing-top img{
    transform: rotate(180deg);
}

.facing-left img{
    transform: rotate(90deg);
}

.facing-right img{
    transform: rotate(270deg);
}

.stacked img {
    position: absolute
}

.row {
    clear: both;
    width: 100%;
    overflow: hidden;
}

.selected {
    border: solid;
    border-color: yellow;
}
</style>

<script type='text/javascript'>
$(document).ready(function() {

    // zone click function
    $(".zone").click(function() {
        if ($('.selected').length != 0 && $(this).has($('.selected')).length == 0) {
            console.log("Request move " + $('.selected').attr('id'));
            requestMoveCard($('.selected').attr('id'), $(this).attr('id'));
        }
    });
});

socket.on('state', function (data) {

    console.log(data);

    for (i = 0; i < data.cards.length; i++) {
        d = data.cards[i];
        d.class = "card";
        d.id = "card" + d.game_id;
        addCard(d, "staging_area");
    }

    // Add all cards to the proper zones
    for (i = 0; i < data.zones.length; i++) {
        zone = data.zones[i];
        $("#" + zone.name).attr('id', "zone" + zone.game_id);
        for (j = 0; j < zone.cards.length; j++) {
            moveCard("card" + zone.cards[j], "zone" + zone.game_id, 0);
        }
    }

    $(".deck").click(function() {
        data = Object();
        data.action_name = 'draw';
        socket.emit('action', data);
        $('.selected').removeClass('selected');
    });

    // Make sure we register all callbacks
    $(".card").click(function() {
        if($(this).attr('face_up') == 'false') {
            console.log('Clicked on face down card.');
            return
        }

        if ($('.selected').length == 0) {
            $(this).addClass('selected');
        } else if ($(this).hasClass('selected')) {
            $(this).removeClass('selected');
        } else {
            parent = $(this).parent();
            parent.click.apply(parent);
        }
        console.log($('.selected').attr('id') + " is selected.");
    });
});
</script>

<div class="layout">
    <button onclick="socket.emit('start');">Start</button>
    <div class="table" id="region0">
        <div class="horizontal-fan zone" id="zone0"></div>
        <div class="stacked zone" id="discardzone0"></div>
        <div class="vertical-fan facing-left zone" id="zone1"></div>
        <div class="stacked zone" id="discardzone1"></div>
        <div class="horizontal-fan facing-up" id="zone2"></div>
        <div class="stacked zone" id="discardzone2"></div>
        <div class="vertical-fan facing-right" id="zone3"></div>
        <div class="stacked zone" id="discardzone3"></div>
        <div class="playarea" id="region1">
            <div class="zone" id="playzone0"></div>
            <div class="facing-left zone" id="playzone1"></div>
            <div class="facing-up zone" id="playzone2"></div>
            <div class="facing-right zone" id="playzone3"></div>
        </div>
    </div>
</div>