<style type="text/css">
.zone {
    float: left;
    width: 80px;
    height: 100px;
    margin: 5px;
    padding: 15px;
    border: 1px dotted #ccc;
}

.zone#hand {
    width: 200px;
}

.zone.last {
    float: right;
}

.victory {
    float: right;
}

.vertical-fan {
    height: 350px;
}

.vertical-fan img {
    margin-bottom: -68px;
}

.stacked img {
    position: absolute
}

.row {
    clear: both;
    width: 100%;
    overflow: hidden;
}

.selected {
    border: solid;
    border-color: yellow;
}
</style>

<script type='text/javascript'>
$(document).ready(function() {

    // zone click function
    $(".zone").click(function() {
        if ($('.selected').length != 0 && $(this).has($('.selected')).length == 0) {
            console.log("Request move " + $('.selected').attr('id'));
            requestMoveCard($('.selected').attr('id'), $(this).attr('id'));
        }
    });
});

socket.on('state', function (data) {

    console.log(data);

    for (i = 0; i < data.cards.length; i++) {
        d = data.cards[i];
        d.class = "card";
        d.id = "card" + d.game_id;
        addCard(d, "staging_area");
    }

    // Add all cards to the proper zones
    for (i = 0; i < data.zones.length; i++) {
        zone = data.zones[i];
        $("#" + zone.name).attr('id', "zone" + zone.game_id);
        for (j = 0; j < zone.cards.length; j++) {
            moveCard("card" + zone.cards[j], "zone" + zone.game_id, 0);
        }
    }

    $(".deck").click(function() {
        data = Object();
        data.action_name = 'draw';
        socket.emit('action', data);
        $('.selected').removeClass('selected');
    });

    // Make sure we register all callbacks
    $(".card").click(function() {
        if($(this).attr('face_up') == 'false') {
            console.log('Clicked on face down card.');
            return
        }

        if ($('.selected').length == 0) {
            $(this).addClass('selected');
        } else if ($(this).hasClass('selected')) {
            $(this).removeClass('selected');
        } else {
            parent = $(this).parent();
            parent.click.apply(parent);
        }
        console.log($('.selected').attr('id') + " is selected.");
    });
});
</script>

<div class="layout">
    <button onclick="socket.emit('start');">Start</button>
    <div class="row" id="region1">
        <div class="stacked zone deck" id="deck" style="float: left;"></div>
        <div class="stacked zone" id="deck_flipped"></div>
        <div class="stacked zone victory" id="victory_zone1"></div>
        <div class="stacked zone victory" id="victory_zone2"></div>
        <div class="stacked zone victory" id="victory_zone3"></div>
        <div class="stacked zone victory" id="victory_zone4"></div>
    </div>
    <div class="row" id="region2">
        <div id="play_zone1" class="vertical-fan zone"></div>
        <div id="play_zone2" class="vertical-fan zone"></div>
        <div id="play_zone3" class="vertical-fan zone"></div>
        <div id="play_zone4" class="vertical-fan zone"></div>
        <div id="play_zone5" class="vertical-fan zone"></div>
        <div id="play_zone6" class="vertical-fan zone"></div>
        <div id="play_zone7" class="vertical-fan zone last"></div>
    </div>
</div>