THIS IS NOT COMPLETE.

This was put together in around 30 minutes of brainstorming
with Graham. It is not complete, and probably doesn't run;
it is mainly intended to show how we want to approach the problem.
At some point we can flesh this out to make it work fully.